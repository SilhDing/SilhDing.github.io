### Run Jenkins as a Docker Container: what do the parameters mean?

It is not hard to run Jenkins as a docker container. However, to understand what the parameters in the `docker run` command mean would greatly enhance our understanding of Docker's mechanism in **volume**.

    docker run \
        --rm \
        -u root \
        -v jenkins-data:/var/jenkins_home \
        -v /var/run/docker.sock:/var/run/docker/scok \
        -v "$HOME":/home \
        jenkinsci.blueocean
        
Here we focus on the first and the last `-v` parameters。

- the first `-v`：
Maps the `/var/jenkins_home` directory in the container to the Docker volume with the name `jenkins-data`. If this volume does not exits, then this `docker run` command will automatically create the volume for you.
        
- the last `-v`:
Maps the `$HOME` directory on the host (i.e. your local) machine (usually the `/Users/<your-username>` directory) to the `home` directory in the container.
 
 
The usage of **volume** here (`-v`) is the reason of the fact that we could still see our build history in Jenkins although we run a new Jenkins container (this is strange since images never save data which are created in their containers, unless you use command `docker commit`). Note that **data in volume is shared between containers**; any modification to volume would take effect immediately, which, however, would make no impact on images. In addition, volume would always be saved even when the containers are stopped or even removed; that is, **volume are indepedent of images and container**.

To see all volumes:

    $ docker volume ls
    
To learn how a container is assigned to the volumes:

    $ docker inpect <container-name>
    
and then find key `Mounts`, e.g. (the example above), 

    "Mounts": [
        {
            "Type": "bind",
            "Source": "/var/run/docker.sock",
            "Destination": "/var/run/docker.sock",
            "Mode": "",
            "RW": true,
            "Propagation": "rprivate"
        },
        {
            "Type": "bind",
            "Source": "/Users/MacbookofSilhouette",
            "Destination": "/home",
            "Mode": "",
            "RW": true,
            "Propagation": "rprivate"
        },
        {
            "Type": "volume",
            "Name": "jenkins-data",
            "Source": "/var/lib/docker/volumes/jenkins-data/_data",
            "Destination": "/var/jenkins_home",
            "Driver": "local",
            "Mode": "z",
            "RW": true,
            "Propagation": ""
        }
    ]

To get information of a specific volume:

    $ docker volume inspect <volume-name>
    
You will get like:

    [
        {
            "CreatedAt": "2018-05-08T02:23:21Z",
            "Driver": "local",
            "Labels": null,
            "Mountpoint": "/var/lib/docker/volumes/jenkins-data/_data",
            "Name": "jenkins-data",
            "Options": null,
            "Scope": "local"
        }
    ]

