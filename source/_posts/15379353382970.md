## 32 Longest Valid Parentheses

Given a string containing just the characters `'('` and `')'`, find the length of the longest valid (well-formed) parentheses substring. 

这个题没啥特别，只是想分享一个机智的解法。

这个题的常见解法是用stack做，stack最后只剩下所有的不合法的括号；或者用dp做也可以。但是下面一个解法很神奇。

```java
class Solution {
    public int longestValidParentheses(String s) {
        int left = 0, right = 0;
        int n = s.length();
        int res = 0;
        for (int i = 0; i < n; i++) {
            if (s.charAt(i) == '(') left ++;
            else right ++;
            
            if (left == right) res = Math.max(res, right * 2);
            
            if (left < right) {
                left = 0; 
                right = 0;
            }
        }
        
        left = 0;
        right = 0;
        
        for (int i = n-1; i >= 0; i--) {
            if (s.charAt(i) == '(') left ++;
            else right ++;
            
            if (left == right) res = Math.max(res, right * 2);
            if (right < left) {
                left = 0;
                right = 0;
            }
        }
        return res;
    }
}
```

先简单来说，这里是使用的是简单的计数方法，现在，假设我们只有多余的`)`在里面，那么很简单，一旦出现`)`比`(`要多的情况，就说明一切计数要重新开始了，每次出现两者是相同的，那么就可以更新结果了。另一方面，如果还要考虑多余的`(`的情况的话，那就从后往前计数。两者是对称的。